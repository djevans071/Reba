<!DOCTYPE html>

{% extends "base.html" %}
{% block title %}Bike Flow | Station Output{% endblock %}
{% block body %}

<div class="container">
  <div class="starter-template">
    <h2>Please select a station</h2>
  </div>

  <form class="form-inline" method="GET" action="{{ url_for('output') }}">
    <center>
      <div class="form-group">
        <div class="input-group">
          <span class="input-group-addon">Station</span>
          <select name="station-select" class="selectpicker form-control" onchange="this.form.submit()">
                <option value="{{ station_df[station_df.id == selected_id].id }}" disabled selected></option>
                {% for _, x in station_df.iterrows() %}
                <option value="{{ x.id }}">{{ x['neighborhood'] }} | {{ x['name'] }}</option>
                {% endfor %}
              </select>
        </div>
        <!-- <button type="submit" class="btn btn-default">Go</button> -->
      </div>
    </center>
  </form>
</div>


<br><br>



<!-- New Container -->
<div class="container">
  <div class="jumbotron-narrow">
    <h2>Results: </h2>


    <div class="col-md-6">
      <div class="chart-wrapper">
        <div class="chart-title">
          Hourly Flows for Station: <b>{{ st_info[0] }}</b> | <b>{{ st_info[1] }}</b>
        </div>
        <div class="chart-stage">
          <div id="grid-1-1">
            {{ plot | safe }}
          </div>
        </div>
        <div class="chart-notes">
          You are looking at the average number of bikes as a fraction of total available docks that enter this station on <b>{{ dayofweek }}s<b>. The red bar indicates the current hour.
        </div>
      </div>
    </div>

    <div class="col-md-6">
      <div class="chart-wrapper">
        <div class="chart-title">
          Map of {{ st_info[0] }}
        </div>
        <div class="chart-stage">
          <div id="grid-1-2">
            {% include "station_map.html" %}
          </div>
        </div>
        <div class="chart-notes">
          Current Availability: <b>{{ bike_avail['availableBikes'].iloc[0] }}</b> bikes,  <b>{{ bike_avail['availableDocks'].iloc[0] }}</b> empty docks

          <br>out of <b>{{ bike_avail['totalDocks'].iloc[0] }}</b> total docks
        </div>
      </div>
    </div>

  </div>
</div>

<br><br>

<!-- /.container -->

<div class="container">
  <div class="starter-template">
    <h2>Rebalancing Recommendation:</h2>
       <p class="lead">For this station at {{time}} (temperature: {{now_temp}}F), the flow is {{rec}}. <br>
      {% if rec == 'Station Offline' or rec == 'Prediction Failed' %}
        <strong>{{rec}}</strong>
      {% elif (rec < 0.15) and (rec > -0.15) %}
        <span style="color:blue;font-weight:bold">No Rebalancing Necessary</span>
      {% elif rec >= 0.15 %}
         <span style="color:red;font-weight:bold">Remove Bikes</span>
      {% elif rec <= -0.15 %}
         <span style="color:green;font-weight:bold">Add Bikes</span>
      {% endif %}
       </p>

  </div>

</div>
<!-- /.container-->

{% endblock %}
